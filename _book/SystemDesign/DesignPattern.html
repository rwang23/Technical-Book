<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Design Pattern | Lintcode Solution Book</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.4.3">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
    

        
    
    
    <link rel="next" href="../SystemDesign/Scale.html" />
    
    
    <link rel="prev" href="../SystemDesign/OperatingSystems.html" />
    

        
    </head>
    <body>
        
        
    <div class="book" data-level="1.3" data-basepath=".." data-revision="Tue Sep 27 2016 01:13:50 GMT-0400 (EDT)">
    

<div class="book-summary">
    <div class="book-search" role="search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="SystemDesign/index.html">
            
                
                    <a href="../SystemDesign/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        System Design
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="SystemDesign/Network.html">
            
                
                    <a href="../SystemDesign/Network.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        Network
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="SystemDesign/OperatingSystems.html">
            
                
                    <a href="../SystemDesign/OperatingSystems.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Operating Systems
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="1.3" data-path="SystemDesign/DesignPattern.html">
            
                
                    <a href="../SystemDesign/DesignPattern.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                        Design Pattern
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="SystemDesign/Scale.html">
            
                
                    <a href="../SystemDesign/Scale.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.4.</b>
                        
                        Scale the Web Application
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="SystemDesign/web-craw.html">
            
                
                    <a href="../SystemDesign/web-craw.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.5.</b>
                        
                        web-craw
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="TechnicalQuestions/index.html">
            
                
                    <a href="../TechnicalQuestions/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Technical Questions
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="TechnicalQuestions/GeneralQuestion.html">
            
                
                    <a href="../TechnicalQuestions/GeneralQuestion.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        General Questions
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="TechnicalQuestions/LinuxCommand.html">
            
                
                    <a href="../TechnicalQuestions/LinuxCommand.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Linux Command
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="TechnicalQuestions/Network.html">
            
                
                    <a href="../TechnicalQuestions/Network.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        Network Questions
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="TechnicalQuestions/Database.html">
            
                
                    <a href="../TechnicalQuestions/Database.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                        Database
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="TechnicalQuestions/OperatingSystem.html">
            
                
                    <a href="../TechnicalQuestions/OperatingSystem.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.</b>
                        
                        Operating System
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="TechnicalQuestions/JavaQuestions.html">
            
                
                    <a href="../TechnicalQuestions/JavaQuestions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.6.</b>
                        
                        Java Questions
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="Git/index.html">
            
                
                    <a href="../Git/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Git
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="Git/git.html">
            
                
                    <a href="../Git/git.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        Git
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="bash/index.html">
            
                
                    <a href="../bash/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Bash Command
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="bash/BashCommand.html">
            
                
                    <a href="../bash/BashCommand.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        Bash Command
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Share on Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Share on Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Share on Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Share on Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Share on Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    
    


    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >Lintcode Solution Book</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="design-pattern">Design Pattern</h1>
<p><a href="http://www.programmerinterview.com/index.php/design-pattern-questions/design-pattern-interview-question-1/" target="_blank">Design pattern from programmer interview</a></p>
<h2 id="singleton-pattern">Singleton Pattern</h2>
<p>Sometimes it&apos;s important to have only one instance for a class. For example, in a system there should be only one window manager (or only a file system or only a print spooler). Usually singletons are used for centralized management of internal or external resources and they provide a global point of access to themselves.</p>
<h3 id="example">Example</h3>
<p>Accesing resources in shared mode
Logger Classes</p>
<h2 id="factory-pattern">Factory Pattern</h2>
<p><a href="http://www.oodesign.com/factory-pattern.html" target="_blank">Good explain</a>
The client needs a product, but instead of creating it directly using the new operator,
it asks the factory object for a new product, providing the information about the type of object it needs.</p>
<p>The factory instantiates a new concrete product and then returns to the client the newly created product(casted to abstract product class).</p>
<p>The client uses the products as abstract products without being aware about their concrete implementation.</p>
<h4 id="example">Example</h4>
<p>For example a graphical application works with shapes.
In our implementation the drawing framework is the client and the shapes are the products. All the shapes are derived from an abstract shape class (or interface).
The Shape class defines the draw and move operations which must be implemented by the concrete shapes.
Let&apos;s assume a command is selected from the menu to create a new Circle.
The framework receives the shape type as a string parameter, it asks the factory to create a new shape sending the parameter received from menu.
The factory creates a new circle and returns it to the framework,
casted to an abstract shape.
Then the framework uses the object as casted to the abstract class without being aware of the concrete object type.</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProductFactory</span></span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> Product <span class="hljs-title">createProduct</span><span class="hljs-params">(String ProductID)</span></span>{
        <span class="hljs-keyword">if</span> (id==ID1)
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> OneProduct();
        <span class="hljs-keyword">if</span> (id==ID2) <span class="hljs-keyword">return</span>
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> AnotherProduct();
        ... <span class="hljs-comment">// so on for the other Ids</span>

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>; <span class="hljs-comment">//if the id doesn&apos;t have any of the expected values</span>
    }
    ...
}
</code></pre>
<h4 id="advantage">Advantage</h4>
<p>The advantage is obvious: New shapes can be added without changing a single line of code in the framework(the client code that uses the shapes from the factory). As it is shown in the next sections, there are certain factory implementations that allow adding new products without even modifying the factory class.</p>
<h2 id="builder-pattern">Builder Pattern</h2>
<p>This pattern allows a client object to construct a complex object by specifying only its type and content, being shielded from the details related to the object&#xFFFD;s representation. This way the construction process can be used to create different representations. The logic of this process is isolated form the actual steps used in creating the complex object, so the process can be used again to create a different object form the same set of simple objects as the first one.</p>
<p>Defines an instance for creating an object but letting subclasses decide which class to instantiate
Refers to the newly created object through a common interface</p>
<h3 id="suppose-you-have-a-logger-class-that-is-used-to-log-error-and-warning-messages-how-can-you-implement-this-class-while-using-the-singleton-design-pattern">Suppose you have a logger class that is used to log error and warning messages. How can you implement this class while using the Singleton design pattern?</h3>
<p>The Singleton design pattern &#x2013; when applied to a given class &#x2013; basically limits the class itself to having just one instance created.</p>
<p>So, if we want to implement the Singleton design pattern with a logger class, it means that there can be at most one instance of the logger class. How can we accomplish this? First, let&#x2019;s rephrase that question into something more specific to the problem at hand &#x2013; how can we control the initialization of a class? Well, through the constructor of course.</p>
<p>A private constructor is key to the Singleton</p>
<p>More specifically, if we make the constructor private, this means that no one outside of the class can create an instance of the class. So, the one and only instance of the class will be created within the logger class itself, and not outside of the logger class.</p>
<p>Now, here is what the Java code for our Logging class would look like:</p>
<p>Example of Singleton in Java</p>
<pre><code class="lang-java"><span class="hljs-comment">// Implements a simple logging class using a singleton.</span>
    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Logging</span> </span>{

    <span class="hljs-comment">// this creates the actual Singleton instance</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Logging singletonInstance = <span class="hljs-keyword">new</span> Logging();

    <span class="hljs-comment">/* Private constructor prevents others from
       instantiating this class: */</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">Logging</span><span class="hljs-params">()</span>
    </span>{
    }

    <span class="hljs-comment">// this method returns the singleton instance</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Logging <span class="hljs-title">getSingleton</span><span class="hljs-params">()</span>
    </span>{
      <span class="hljs-keyword">return</span> singletonInstance;
    }

    <span class="hljs-comment">/* This will print a message to the screen:
       sample call: Logging.getSingleton().log(&quot;testing message&quot;);
    */</span>

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">log</span><span class="hljs-params">( String message )</span>
    </span>{
      System.out.println( System.currentTimeMillis()
      + <span class="hljs-string">&quot;: &quot;</span> + message );
    }
}
</code></pre>
<h3 id="suppose-you-have-an-application-that-uses-the-singleton-design-pattern-for-one-of-it%E2%80%99s-classes-but-the-problem-is-that-the-singleton-is-expensive-to-create-because-a-resource-intensive-database-access-is-necessary-to-create-the-singleton-what-can-you-do-to-possibly-add-some-efficiency-to-the-process-of-creating-a-singleton">Suppose you have an application that uses the Singleton Design pattern for one of it&#x2019;s classes. But, the problem is that the singleton is expensive to create, because a resource intensive database access is necessary to create the singleton. What can you do to possibly add some efficiency to the process of creating a singleton?</h3>
<p>This question is part 2 in our series of design interview questions. It will help if you read part 1 first, since we refer to some of the code that&#x2019;s used in part 1.</p>
<p>So, the question here is what can you do to help a situation in which a Singleton is expensive to create.</p>
<p>The Singleton design pattern says that there can only be one instance of the class to which the pattern is applied. But, the Singleton design pattern does not say anything at all about when exactly that instance must be created.</p>
<p>Create the instance right before it is needed</p>
<p>Let&#x2019;s use the Logging class example that we went through in part 1 &#x2013; you can just assume that creating the singleton for the Logging class is very resource intensive.
So, instead of creating an instance of the Logging class when the class is loaded, we will just create the instance right before that instance is actually needed.</p>
<p>This means that we will need to change the getSingleton() method to initialize the instance of the Logging class, but only if that instance has not been initialized already. So, the new getSingleton() method would now look like this &#x2013; where singletonInstance represents the instance of the singleton of course:</p>
<pre><code class="lang-java">
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Logging <span class="hljs-title">getSingleton</span><span class="hljs-params">()</span> </span>{
<span class="hljs-comment">/*Create the singleton instance only if it&apos;s
  null, which means no one else has created it
  already
*/</span>
             <span class="hljs-keyword">if</span>( singletonInstance  == <span class="hljs-keyword">null</span> ){
                 singletonInstance  = <span class="hljs-keyword">new</span> Logging();
             }

             <span class="hljs-keyword">return</span> singletonInstance;
         }
</code></pre>
<p>Just for reference, this is what the getSingleton() method looked like before &#x2013; note that the singletonInstance is not being initialized:</p>
<pre><code class="lang-java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Logging <span class="hljs-title">getSingleton</span><span class="hljs-params">()</span>
</span>{
  <span class="hljs-keyword">return</span> singletonInstance;
}
</code></pre>
<p>And the singleton itself will be changed to look like this:</p>
<pre><code>/* note that it is no longer final and it initially points to null
   the old version looked like this - because it was initialized
   without anyone actually calling the getSingleton method :
   private static final Logging singletonInstance = new Logging();
*/
</code></pre><p>private static Logging singletonInstance = null;
Note that the method used to retrieve the Singleton instance will now check to see if the &#x201C;instance&#x201D; member variable is null. If it is null that of course means that the singleton has not yet been created, so it will then actually create the instance. This will of course only happen the first time the getInstance method is called. But if instance is not null, the instance will simply be returned.</p>
<p>This technique is known as lazy loading</p>
<p>So, we want to repeat that the key thing to understand here is that the method has been changed to check if an instance already exists. If it does exist, it just returns that instance. If it doesn&#x2019;t exist, then it just creates a new instance and returns that one. The whole point of this is to save resources by instantiating the Singleton only when it&#x2019;s actually needed. This technique is commonly known as lazy loading, or deferred initialization, because of the fact that the singleton instance is created only once it&#x2019;s needed &#x2013; hence it&#x2019;s &#x201C;lazy&#x201D; or &#x201C;deferred&#x201D;.</p>
<h2 id="obserber-pattern">Obserber Pattern</h2>
<p>Extending an objects functionality can be done statically (at compile time) by using inheritance however it might be necessary to extend an objects functionality dynamically (at runtime) as an object is used.
The intent of Obserber pattern is to add additional responsibilities dynamically to an object.</p>
<h2 id="when-using-the-observer-pattern-what-approaches-can-be-used-by-the-subject-so-that-it%E2%80%99s-observers-can-be-more-efficiently-updated">When using the Observer pattern, what approaches can be used by the subject so that it&#x2019;s observers can be more efficiently updated?</h2>
<p>Let&#x2019;s go through a quick overview of the Observer pattern before answering the actual question.</p>
<p>In the Observer pattern, an object can broadcast any changes in it&#x2019;s state to any &#x201C;observers&#x201D; &#x2013; which are basically other classes &#x2013; that want to know about it&#x2019;s state. Why would an &#x201C;observer&#x201D; be interested in another object&#x2019;s state? Well, because the state of the object can affect the state of the observer &#x2013; read below for an actual example. So, the object being observed is called the &#x201C;subject&#x201D;. These observers are typically notified when the subject changes because the subject will call a method belonging to an observer.</p>
<h3 id="observer-pattern-is-used-in-mvc">Observer Pattern is used in MVC</h3>
<p>The Observer pattern plays a key role in the popular MVC &#x2013; Model View Controller &#x2013; architectural pattern. Any change in state to the Model &#x2013; which represents the underlying data, and is the &#x201C;subject&#x201D; &#x2013; will result in a notification to the View, which is the Observer.</p>
<p>Now, let&#x2019;s answer the actual question. One problem that may arise with the Observer pattern is that a subject may be updating it&#x2019;s state too frequently. This means that the subject is spending a great deal of time updating it&#x2019;s observers, which is of course inefficient. In this scenario, a possible solution is to simply have the subject turn off all updates temporarily. Then, the subject can make the changes in that period of time. And, once the changes are complete, the subject can go ahead and update any and all observers with one big notification. This is far more efficient because of the fact that only notification is sent out to observers as opposed to constantly sending out notifications.</p>
<h3 id="finding-a-good-strategy-with-the-observer-pattern">Finding a good strategy with the Observer Pattern</h3>
<p>One other possible dilemma when dealing with the Observer pattern is figuring out a good strategy for observers to know what has been changed in the subject. Let&#x2019;s consider an example website (like Yahoo.com) that has to update particular parts of the page (the Observer) when the data (the subject) changes. So when a stock price changes, Yahoo will have to update the stock portion of the page, and if there&#x2019;s some breaking news, then Yahoo will have to update the &#x201C;Latest News&#x201D; portion of the page, etc.</p>
<p>In order for this process to be efficient, the Observer (which is the actual webpage) would need to know what data (the subject) has changed &#x2013; whether that data is in the form of a database, XML file, or whatever. But, instead of having the page ask the data (or query the data) to find out what exactly has changed, it would probably be more efficient to have the data (the subject) pass on that information to the webpage. This information passed to the webpage from the subject could just be added to the normal update notification, and then the webpage can update the appropriate portion of the page that needs to change (maybe using AJAX).</p>
<h1 id="decorator-pattern">Decorator Pattern</h1>
<h2 id="when-and-why-would-you-favor-the-decorator-pattern-over-inheritance">When and why would you favor the Decorator pattern over inheritance?</h2>
<p>Just a quick note: even if you don&#x2019;t know much about the Decorator pattern, you should still be able to understand the discussion here.</p>
<p>The Decorator design pattern is used to wrap one object with another object. The point of wrapping one object with another object is so that the original object&#x2019;s behavior can be modified.</p>
<p>The wrapper object can be used as a substitute for the original object because of the fact that both objects either share the same abstract class or implement the same interface.</p>
<h3 id="inheritance-vs-the-decorator-pattern">Inheritance vs the Decorator Pattern</h3>
<p>The thing that both inheritance and the decorator pattern have in common is the fact that they both allow you to change how an object behaves. But how they achieve this change in behavior is where inheritance and the decorator pattern are different.</p>
<h3 id="the-decorator-pattern-makes-run-time-object-changes-easier">The Decorator pattern makes run-time object changes easier</h3>
<p>With inheritance, dynamically changing the behavior of an object can be a burdensome process. Suppose that you want to dynamically change the behavior of an object using inheritance. Since we are dealing with inheritance, you will need to use a child class and then create an object of that child class in order to get the desired effect. After you create the child class object you will then need to copy the state from the current object into the new child class object &#x2013; because you will presumably want to still save the state of the current object. And finally, after you are done copying the state, you will want to discard the old object since you no longer need it. This is obviously a long process that can be quite a pain to implement over and over again.</p>
<p>But if we use the Decorator pattern instead, it is a lot easier to dynamically change the behavior of the object. All we have to do is wrap the current object with another object that contains the extra behavior that is desired.</p>
<h3 id="the-decorator-pattern-makes-multiple-behavior-modifications-easier">The Decorator Pattern makes multiple behavior modifications easier</h3>
<p>Suppose that you have many different changes that you would like to implement for a given class. And, also assume that those changes do not conflict with one another, so you can combine those modifications in any order without having to worry about potential conflicts. In this scenario, using the Decorator pattern can be very advantageous over inheritance. Let&#x2019;s go over an example to understand this concept further.</p>
<p>As our example, let&#x2019;s say that we have a Car class. This class could have many different behaviors like Automatic, Manual, Convertible, etc. We could have these behaviors implemented using inheritance. So, we could create classes called AutomaticCar, ManualCar, or ConvertibleCar that all derive from the Car class. While this is just fine for a reasonable number of child classes, for more behaviors (like LuxuryCar, SedanCar, etc) this process of creating more and more child classes can quickly become very messy. But, by using the Decorator pattern instead of inheritance, we can avoid this problem of having far too many child classes. This is because with the Decorator pattern, each and every behavior is described by just one Decorator class. And, you can specify whatever behaviors you want by applying the desired set of decorations.</p>
<h3 id="the-decorator-pattern-is-not-necessary-in-non-dynamic-situations">The Decorator pattern is not necessary in non-dynamic situations</h3>
<p>Using the Decorator pattern is pretty darn complex. If you actually need to dynamically change the way an object behaves, then using the Decorator pattern is a good idea. But, if you do not need to dynamically change the way an object behaves, then inheritance is the better option because you then do not need to deal with the complexity of the Decorator patter</p>
<h2 id="how-would-you-implement-thread-safety-in-a-singleton">How would you implement thread safety in a singleton?</h2>
<p>First, let&#x2019;s go over some background on why thread safety may be an issue with singletons. When dealing with singletons, there are two primary ways to initialize the singleton &#x2013; inside a method using a technique known as lazy loading, or outside a method. Lazy loading is used to save resources by only initializing the singleton when the instance is actually needed. This is what lazy loading could look like for a singleton:</p>
<pre><code class="lang-java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Logging <span class="hljs-title">getSingleton</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-comment">/*Create the singleton instance only if it&apos;s
    null, which means no one else has created it
    already:
   */</span>

   <span class="hljs-keyword">if</span>( singletonInstance  == <span class="hljs-keyword">null</span> ){
      singletonInstance  = <span class="hljs-keyword">new</span> Logging();
   }

   <span class="hljs-keyword">return</span> singletonInstance;
}
</code></pre>
<p>Just for reference, this is what the getSingleton() method looks like without lazy loading &#x2013; note that the singletonInstance is not being initialized:</p>
<pre><code class="lang-java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Logging <span class="hljs-title">getSingleton</span><span class="hljs-params">()</span>
</span>{
  <span class="hljs-keyword">return</span> singletonInstance;
}
</code></pre>
<p>You can read more about lazy loading in Singletons here: Design Pattern Interview Question 2.</p>
<h2 id="having-the-singleton-initialized-in-a-method-can-be-a-problem">Having the singleton initialized in a method can be a problem</h2>
<p>Having the singleton initialized inside a method creates a new problem. What if two or more threads call the method at the same time?</p>
<p>For example, let&#x2019;s say that a thread &#x2013; let&#x2019;s call it thread A &#x2013; switches out immediately after checking to see if the singleton instance is NULL. Now, let&#x2019;s say that another thread &#x2013; call it thread B &#x2013; gets switched into the method call and actually completes the execution of the getInstance() method. This means that thread B will actually retrieve and construct an instance of the singleton. But, thread A will get switched back into the method and then create another instance of the singleton! So, now we have two singleton instances, when the whole point of a singleton is to only allow one instance to be created.</p>
<h2 id="make-the-singleton-thread-safe-is-the-solution">Make the singleton thread safe is the solution</h2>
<p>This is clearly a problem, but there is a solution. That solution is to make the method thread safe. How do we make a method thread safe? Well, it&#x2019;s pretty simple actually &#x2013; we just add the synchronized keyword to the method signature to make it thread safe. So, this is what the method ends up looking like:</p>
<pre><code class="lang-java"><span class="hljs-comment">// Return the singleton instance.</span>
     <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">static</span> Logger <span class="hljs-title">getInstance</span><span class="hljs-params">()</span> </span>{
         <span class="hljs-keyword">if</span>( instance == <span class="hljs-keyword">null</span> ){
             instance = <span class="hljs-keyword">new</span> Logger();
         }

         <span class="hljs-keyword">return</span> instance;
     }
</code></pre>
<h2 id="how-does-the-synchronized-keyword-make-a-method-thread-safe">How does the synchronized keyword make a method thread safe?</h2>
<p>Adding the synchronized keyword to the method signature basically prevents more than one thread from entering the method at a given time. So, one thread must run the method to completion before another thread can even enter the method. This will of course prevent multiple singletons from being created because once the first singleton is created, any subsequent calls to the getInstance method will just return the one instance that has already been created. And that is what thread safety is all about.</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../SystemDesign/OperatingSystems.html" class="navigation navigation-prev " aria-label="Previous page: Operating Systems"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../SystemDesign/Scale.html" class="navigation navigation-next " aria-label="Next page: Scale the Web Application"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
